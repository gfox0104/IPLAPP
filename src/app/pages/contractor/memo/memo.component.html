<div class="container-fluid mt-2">
  <div  style="margin-top: 1%;">
    <h3 class="module-box-header mb-0">Mass mail <a class="pull-right" data-toggle="tooltip" (click)="SetHelpFlag()" data-placement="top"
      title="Item Help" style="cursor: pointer;">Need Help
      <i class="fas fa-question"></i>&nbsp; &nbsp;
    </a></h3>
    <div class="row m-0 module-subheader p-1 pl-2" >
      <div class="mass-btn-group">
        <button class="btn btn-primary"  (click)="templateopen()">Template</button>
        <button class="btn btn-primary mx-1"  (click)="schedopen()">Sched message</button>
        <button class="btn btn-primary"  (click)="previouslySentOpen()">Previously sent</button>
      </div>
    </div>
    <div class="module-box">
      <div class="row m-0 p-2">
        <div class="col-12">

            <form [formGroup]="formUsrCommonGroup">
            <div class=" p-2 ">
            <div class="row">
              <div class="col-md-12 col-sm-12 row">
                <div class="col-md-2 col-sm-6 col-6 text-right align-self-center" [ngClass]="{ 'HelpCursor': isHelpActive }"
                (click)="DispalyInfo($event,'Select group')" >Select group</div>
                <div class="col-md-2 col-sm-6 col-6">
                  <!-- <input type="text" style="width: 100%;"/> -->
                  <!-- <kendo-dropdownlist
                       [defaultItem]="defaultItem1"

                          [data]="dataGroup"
                          [textField]="'Grp_Name'"
                          [valueField]="'Grp_pkeyID'"
                          (valueChange)="groupChange($event)"
                          [style]="{'width': '100%'}"
                          [ngClass]="{ 'HelpCursor': isHelpActive }"
                         (click)="DispalyInfo($event,'Select group')"
                      >
                      </kendo-dropdownlist> -->

                      <kendo-dropdownlist class="newClass form-control form-control-sm " [data]="dataGroup" (filterChange)="FileFilter($event)"
                    [defaultItem]="defaultItem1" [filterable]="true" [textField]="'Grp_Name'" [valueField]="'Grp_pkeyID'" formControlName="selectGroup"
                    (valueChange)="groupChange($event)" [valuePrimitive]="true"  (click)="DispalyInfo($event,'Select group')">
                  </kendo-dropdownlist>
                </div>

                <div class="col-md-2 col-sm-6 col-6" style="text-align: end;align-self: center;"  [ngClass]="{ 'HelpCursor': isHelpActive }"
                (click)="DispalyInfo($event,'Time to send')"  >Time to send</div>
                <div class="col-md-2 col-sm-6 col-6">
                  <kendo-datetimepicker
                    [format]="format"
                    [(value)]="value"
                    [style]="{'width': '100%'}"
                    [ngClass]="{ 'HelpCursor': isHelpActive }"
                (click)="DispalyInfo($event,'Time to send')"
                  >
                  </kendo-datetimepicker>
                </div>
                <!-- <div class="col-md-2 col-sm-6 col-6" style="text-align: end;align-self: center;" [ngClass]="{ 'HelpCursor': isHelpActive }"
                (click)="DispalyInfo($event,'Subject')" >
                  Subject sss
                </div>
                <div class="col-md-2 col-sm-6 col-6">
                  <input class="form-control form-control-sm" type="text" [(ngModel)]="subject"
                  [ngClass]="{ 'HelpCursor': isHelpActive }"
                (click)="DispalyInfo($event,'Subject')"
                [readonly]="isHelpActive"
                   style="width: 100%;" required/>
                </div> -->
              </div>
            </div>

            <br>
            <div class="row">
              <div class="col-md-12 row align-items-center">

                <div class="offset-md-2 col-md-10 col-sm-12 justify-content-center">
                  <kendo-fileselect
                   [(ngModel)]="myFiles" [restrictions]="fileRestrictions"  (select)="displaySuccessDocument($event)"
                   [ngClass]="{ 'HelpCursor': isHelpActive }"
                   (click)="DispalyInfo($event,'Select')">
                  </kendo-fileselect>
                </div>
              </div>
            </div>
            <br>
            <div class="row">
              <div class="col-md-12 row align-items-center">
            <div class="col-md-2 col-sm-6 col-6" style="text-align: end;align-self: center;" [ngClass]="{ 'HelpCursor': isHelpActive }"
            (click)="DispalyInfo($event,'Subject')" >
              Subject
            </div>
            <div class="col-md-10 col-sm-6 col-6" >
              <input class="form-control form-control-sm" type="text" [(ngModel)]="subject"
              [ngClass]="{ 'is-invalid': submitted && fx.Subjectfile.errors }"
            (click)="DispalyInfo($event,'Subject')"[ngClass]="{ 'HelpCursor': isHelpActive }"
            [readonly]="isHelpActive" formControlName="Subjectfile"
               style="width: 100%;" required/>
               <!-- <div *ngIf="submitted && fx.Subject.errors" class="invalid-feedback">
                <div *ngIf="fx.Subject.errors.required">this field is required</div>
              </div> -->
              <!-- <div *ngIf="show1" class="invalid-feedback">
                <div >this field is required</div>
              </div> -->

            </div>
            <div *ngIf=" submitted && fx.Subjectfile.errors" class="invalid-feedback">
              <div *ngIf="fx.Subjectfile.errors.required">this field is required</div>
            </div>
            <!-- <div *ngIf="subject1" class="Mydropdown">this field is required</div> -->

            </div>
            </div>

            <!-- <div class="col-md-12 row align-items-center">

              <div class="offset-md-2 col-md-10 col-sm-12 justify-content-center">
                <kendo-fileselect
                 [(ngModel)]="myFiles" [restrictions]="fileRestrictions"  (select)="displaySuccessDocument($event)"
                 [ngClass]="{ 'HelpCursor': isHelpActive }"
                 (click)="DispalyInfo($event,'Select')">
                </kendo-fileselect>
              </div>
            </div> -->

            <br>


            <hr>
            <h4 class="module-subheader p-1 pl-2 mb-0 "     [ngClass]="{ 'HelpCursor': isHelpActive }"
            (click)="DispalyInfo($event,'Body')" style="margin-left: -15px;"
         >
              Body
            </h4>
            <div class="module-box p-1" style="margin-right: 4px; margin-left: -15px;">
            <div class="row">
              <div class="col-md-12">
                <kendo-editor [value]="mailContent" (valueChange)="mailContentChange($event)"
                [ngClass]="{ 'HelpCursor': isHelpActive }"
                (click)="DispalyInfo($event,'Body')"[readonly]="isHelpActive"
             ></kendo-editor>
              </div>
            </div>
            <br>
            <div class="row">
              <div class="col-md-12">
                <div>
                  <label for="InvestmentSihhhze" *ngIf="formUsrCommonGroup.invalid" style="color:red">*
                    fields is required
                  </label>
                </div>


                <button class=" btn btn-primary" (click)="saveMail()">
                  <i class="fa fa-save"></i>
                  Save</button>
              </div>
            </div>
            <br>
          </div>
          </div>
          </form>


      </div>
      <div>

      </div>
      <div>
        <kendo-dialog  *ngIf="templateOpened" (close)="templateclose('cancel')" >
          <kendo-dialog-titlebar class="module-box-header" >
            <div style="font-size: 18px; line-height: 1.3em;">Please add & select template
            </div>
          </kendo-dialog-titlebar>
          <div class="smallModal">

        <form class="module-box p-1">
        <div class="row">
         <div class="col-2">
           <label>Subject</label>
         </div>
         <div class="col-10">
         <input type="text"[(ngModel)]="MassTemplateModelObj.Mass_Template_Subject"
         [ngModelOptions]="{standalone: true}" class="form-control">
        </div>
       </div><br>
       <div class="row">
        <div class="col-2">
          <label>Content</label>
        </div>
        <div class="col-10">
      <textarea class="form-control" [(ngModel)]="MassTemplateModelObj.Mass_Template_Contant"
      [ngModelOptions]="{standalone: true}"rows="4"></textarea>
       </div>
      </div><br>
      <div class="row col-12 justify-content-center">
        <button class="btn btn-primary"(click)="saveMassTemplate()" >Save</button>&nbsp;&nbsp;
        <button class="btn btn-primary">Cancel</button>
      </div>
    </form>
      <hr>
      <div class="row m-0 module-box" style="overflow-x: auto;">
        <kendo-grid #gridUser [kendoGridBinding]="griddetails" [pageSize]="5" [pageable]="true" [sortable]="true"
        [filterable]="false" [selectable]="true" [groupable]="false" [skip]="state.skip" [sort]="state.sort"
        [filter]="state.filter" (dataStateChange)="dataStateChange($event)">
        <kendo-grid-column field="Mass_Template_Subject" title="Subject"
           [width]="200">
        </kendo-grid-column>
        <kendo-grid-column field="Mass_Template_Contant" title="Content"
         [width]="200">
      </kendo-grid-column>

        <kendo-grid-column title="Action"
           width="80">
          <ng-template kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex">
            <a class="edit" data-toggle="tooltip" (click)="showDetails(dataItem)" data-placement="top"
              title="Use">
              <i class="fa fa-plus"></i>
            </a> &nbsp;&nbsp;
            <a class="edit" data-toggle="tooltip" (click)="deleteDetails(dataItem)" data-placement="top"
              title="Delete Record" style="cursor: pointer">
              <i class="fa fa-trash"></i>
            </a>
          </ng-template>
        </kendo-grid-column>

        <ng-template kendoPagerTemplate let-totalPages="totalPages" let-currentPage="currentPage">
          <kendo-pager-prev-buttons></kendo-pager-prev-buttons>
          <kendo-pager-numeric-buttons [buttonCount]="10"></kendo-pager-numeric-buttons>
          <kendo-pager-next-buttons></kendo-pager-next-buttons>
          <kendo-pager-info></kendo-pager-info>
          <kendo-pager-page-sizes [pageSizes]="[15, 30, 50, 100]"></kendo-pager-page-sizes>
        </ng-template>
      </kendo-grid>
      </div>
          </div>
        </kendo-dialog>
      </div>
      <div>
        <kendo-dialog *ngIf="schedOpened" (close)="schedclose('cancel')" >
          <kendo-dialog-titlebar class="module-box-header">
            <div style="font-size: 18px; line-height: 1.3em;">Scheduled memo</div>
          </kendo-dialog-titlebar>
          <div class="container-fluid smallModal2">
                <div class="row m-0 module-box" style="overflow-x: auto;">
                  <kendo-grid  #gridUser [kendoGridBinding]="griddata" [pageSize]="5" [pageable]="true" [selectable]="true"
                [groupable]="false" [reorderable]="true" [sortable]="true" [filterable]="false" [selectable]="true"
                [groupable]="false" >
                <kendo-grid-column field="Mass_Email_Schedule_Time" title="Sched Date"
                   [width]="100">
                  <ng-template kendoGridCellTemplate let-dataItem>
                    {{dataItem.Mass_Email_Schedule_Time | date: 'MM/dd/yyyy'}}
                </ng-template>
                </kendo-grid-column>
                <kendo-grid-column field="Mass_Email_Subject" title="Subject"
                   [width]="200"
                  filter="boolean">
                </kendo-grid-column>
                <kendo-grid-column field="Mass_Email_Message" title="Message"
                 [width]="200"
                filter="boolean">
              </kendo-grid-column>

                <kendo-grid-column field="filename" title="File"
                   width="100">
                </kendo-grid-column>

          </kendo-grid>
                </div>
          </div>
          <!-- <kendo-dialog-actions>
              <button kendoButton (click)="schedclose('no')">No</button>
              <button kendoButton (click)="schedclose('yes')" primary="true">Yes</button>
          </kendo-dialog-actions> -->
        </kendo-dialog>
      </div>
      <div>
        <kendo-dialog *ngIf="previouslySentOpened" (close)="Emaildataclose('cancel')" >
          <kendo-dialog-titlebar class="module-box-header">
            <div style="font-size: 18px; line-height: 1.3em;">Previously sent memo</div>
          </kendo-dialog-titlebar>
          <div class="smallModal2">
            <app-previously-sent></app-previously-sent>
         </div>
        </kendo-dialog>
      </div>
    </div>
  </div>
  </div>




