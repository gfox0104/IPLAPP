<div class="row">
  <div class="col-md-1 sidebar">
    <app-account-sidebar [ActiveLink]="9"></app-account-sidebar>
  </div>
  <div class="col-md-11">
    <div class="container-fluid">
      <div class="row">
        <div class="col-12">
          <div class="card-box">
            <div>
              <br />
              <div class="row">
                <div class="col-md-8">
                  <h3
                    class="page-title"
                    style="font-weight: bolder; padding-left: 12px"
                  >
                    Account
                  </h3>
                </div>
                <div class="col-md-4">
                  <button
                    id="client_viewdetail_1"
                    class="btn btn-primary float-right"
                    (click)="addNewAccount(AccountFORM)"
                  >
                    <i class="fas fa-plus-circle"></i> Add
                  </button>
                </div>
              </div>
              <hr />
              <div class="row griddiv">
                <kendo-grid
                  #gridUser
                  [kendoGridBinding]="AccountList"
                  [pageSize]="15"
                  [pageable]="true"
                  [sortable]="true"
                  [filterable]="true"
                  [selectable]="true"
                  [groupable]="false"
                  [skip]="state.skip"
                  [sort]="state.sort"
                  [filter]="state.filter"
                  (dataStateChange)="dataStateChange($event)"
                >
                  <kendo-grid-column
                    field="Acc_Account_Code"
                    title="Number"
                    [headerStyle]="{
                      'background-color': '#323232',
                      color: '#fff',
                      'line-height': '1em'
                    }"
                  >
                  </kendo-grid-column>
                  <kendo-grid-column
                    field="Acc_Account_Name"
                    title="Name"
                    [headerStyle]="{
                      'background-color': '#323232',
                      color: '#fff',
                      'line-height': '1em'
                    }"
                  >
                  </kendo-grid-column>
                  <kendo-grid-column
                    field="Acc_Account_Type_Name"
                    title="Type"
                    [headerStyle]="{
                      'background-color': '#323232',
                      color: '#fff',
                      'line-height': '1em'
                    }"
                  >
                  </kendo-grid-column>

                  <kendo-grid-column
                    field="Acc_Account_Type_Detail_Name"
                    title="Detail Type"
                    [headerStyle]="{
                      'background-color': '#323232',
                      color: '#fff',
                      'line-height': '1em'
                    }"
                  >
                  </kendo-grid-column>
                  
                  <kendo-grid-column
                    title="Action"
                    [headerStyle]="{
                      'background-color': '#323232',
                      color: '#fff',
                      'line-height': '1em'
                    }"
                  >
                    <ng-template
                      kendoGridCellTemplate
                      let-dataItem
                      let-rowIndex="rowIndex"
                    >
                      <button
                        [disabled]="false"
                        (click)="editDetails($event, dataItem, AccountFORM)"
                      >
                        <i class="fa fa-pencil-square-o"></i></button
                      >&nbsp;
                    </ng-template>
                  </kendo-grid-column>
                  <ng-template
                    kendoPagerTemplate
                    let-totalPages="totalPages"
                    let-currentPage="currentPage"
                  >
                    <kendo-pager-prev-buttons></kendo-pager-prev-buttons>
                    <kendo-pager-numeric-buttons
                      [buttonCount]="10"
                    ></kendo-pager-numeric-buttons>
                    <kendo-pager-next-buttons></kendo-pager-next-buttons>
                    <kendo-pager-info></kendo-pager-info>
                    <kendo-pager-page-sizes
                      [pageSizes]="[15, 30, 50, 100]"
                    ></kendo-pager-page-sizes>
                  </ng-template>
                </kendo-grid>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #AccountFORM let-modal>
  <div class="modal-header">
    <button type="button" class="close" aria-label="Close" (click)="close()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div
      class="card-box bg-pattern border border-dark"
      style="background-color: #f7f7f7"
    >
      <form
        [formGroup]="formUsrCommonGroup"
        (ngSubmit)="FormButtonPOPUp(AccountForm)"
        #AccountForm="ngForm"
      >
        <div class="form-row">
          <div
            class="form-group col-md-12 text-center"
            style="color: black; background-color: #9b9b9b"
          >
            <h5>Account</h5>
          </div>
          <br />
        </div>
        <div class="row p-2">
          <div class="col-md-6">
            <div class="form-group">
              <label> Account Type *</label>
              <div class="input-group">
                
                <select
                  class="form-control form-control-sm"
                  [(ngModel)]="Account.Acc_Account_Type"
                  name="Acc_Account_Type"
                  #Acc_Account_Type="ngModel"
                  [ngModelOptions]="{ standalone: true }"
                  (change)="ChangeAccountType($event.target.value, true)"
                >
                  <option [value]="0">select</option>
                  <option
                    [value]="type.Acc_Type_pkeyId"
                    *ngFor="let type of AccountTypeList"
                  >
                    {{ type.Acc_Account_Type }}
                  </option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label> Detail Type <i class="text-danger"> *</i></label>
              <div class="input-group">
                <select
                  class="form-control form-control-sm"
                  [(ngModel)]="Account.Acc_Account_Details"
                  name="Acc_Account_Details"
                  #Acc_Account_Details="ngModel"
                  [ngModelOptions]="{ standalone: true }"
                  (change)="GetNameAccountDetails($event.target.value)"
                  [ngClass]="{
                    'is-invalid':
                      AccountForm.submitted && Account.Acc_Account_Details == 0
                  }"
                >
                  <option [value]="0">select</option>
                  <option
                    [value]="details.Acc_Type_pkeyId"
                    *ngFor="let details of AccountDetailsList"
                  >
                    {{ details.Acc_Detail_Type }}
                  </option>
                </select>
                <div
                  *ngIf="
                    AccountForm.submitted && Account.Acc_Account_Details == 0
                  "
                  class="invalid-feedback"
                >
                  <div *ngIf="Account.Acc_Account_Details == 0">
                    this field is required
                  </div>
                </div>
              </div>
            </div>
            <div class="form-group">
              <div class="input-group">
                <textarea
                  rows="6"
                  class="form-control form-control-sm"
                  [(ngModel)]="Account.Acc_Account_Type_Description"
                  name="Acc_Account_Type_Description"
                  #Acc_Account_Type_Description="ngModel"
                  [ngModelOptions]="{ standalone: true }"
                  disabled
                >
                </textarea>
                
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="form-group">
              <label> Name <i class="text-danger"> *</i></label>
              <div class="input-group">
                <input
                  id="Acc_Account_Name"
                  type="text"
                  [(ngModel)]="Account.Acc_Account_Name"
                  name="Acc_Account_Name"
                  #Acc_Account_Name="ngModel"
                  [ngModelOptions]="{ standalone: true }"
                  class="form-control form-control-sm"
                  required
                  [ngClass]="{
                    'is-invalid':
                      AccountForm.submitted && Acc_Account_Name.invalid
                  }"
                />
                <div
                  *ngIf="AccountForm.submitted && Acc_Account_Name.invalid"
                  class="invalid-feedback"
                >
                  <div *ngIf="Acc_Account_Name.invalid">
                    this field is required
                  </div>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label> Number </label>
              <div class="input-group">
                <input
                  id="Acc_Account_Code"
                  type="text"
                  [(ngModel)]="Account.Acc_Account_Code"
                  name="Acc_Account_Code"
                  #Acc_Account_Code="ngModel"
                  class="form-control form-control-sm"
                  [ngModelOptions]="{ standalone: true }"
                  required
                />
              </div>
            </div>
            <div class="form-group">
              <label> Description</label>
              <div class="input-group">
                <input
                  id="Acc_Account_Description"
                  type="text"
                  [(ngModel)]="Account.Acc_Account_Description"
                  name="Acc_Account_Description"
                  #Acc_Account_Description="ngModel"
                  class="form-control form-control-sm"
                  [ngModelOptions]="{ standalone: true }"
                  required
                />
              </div>
            </div>
            <div class="form-group">
              <div class="custom-control custom-checkbox">
                <input
                  type="checkbox"
                  class="custom-control-input"
                  [(ngModel)]="Account.Acc_Is_Sub_Account"
                  id="Acc_Is_Sub_Account"
                  [ngModelOptions]="{ standalone: true }"
                />
                <label class="custom-control-label" for="Acc_Is_Sub_Account"
                  >Is Sub-Account</label
                >
              </div>
              <select
                [disabled]="!Account.Acc_Is_Sub_Account"
                class="form-control form-control-sm"
                [(ngModel)]="Account.Acc_Parent_Account_Id"
                name="Acc_Parent_Account_Id"
                #Acc_Parent_Account_Id="ngModel"
                [ngModelOptions]="{ standalone: true }"
              >
                <option [value]="0">select</option>
                <option
                  [value]="account.Acc_pkeyId"
                  *ngFor="let account of FilterAccountList"
                >
                  <!-- {{ account.Acc_pkeyId }}--{{ account.Acc_Parent_Account_Id }} -->
                  <section *ngIf="account.Acc_Parent_Account_Id == 0">
                    <label>
                      {{ account.Acc_Account_Code }}
                      {{ account.Acc_Account_Name }}</label
                    >
                    (Account)
                  </section>
                  <section *ngIf="account.Acc_Parent_Account_Id != 0">
                    <label>
                      {{ account.Acc_Account_Code }}
                      {{ account.Acc_Account_Name }}</label
                    >
                    (Sub Account)
                  </section>
                </option>
              </select>
            </div>
          </div>
        </div>
        <hr />
        <div class="row">
          <div class="col-md-2">
            <button
              class="btn btn-success btn-lg float-right"
              (click)="close()"
              type="button"
            >
              Cancel
            </button>
          </div>

          <div class="col-md-8">
            <button class="btn btn-success btn-lg float-right" type="submit">
              <i
                class="fa"
                [ngClass]="{
                  'fa-spin fa-spinner': isLoading,
                  'fa-save': !isLoading
                }"
              ></i>
              {{ button }}
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
</ng-template>
